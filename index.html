<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>42 Explorer</title>
	<link rel="stylesheet" href="style.css">
	<link rel="icon" href="./logoExplorerWhite.ico">
</head>

<body>
	<div class="mainPage">

		<div class="header">
			<a href="https://www.instagram.com/42_explorer" target="_blank">
				<img src="./logoExplorerWhite.png" alt="Logo Explorer" width="100" height="100">
			</a>
			<h1 class="mainTitle">42 Explorer</h1>
		</div>

		<button id="loginButton">Login with 42</button>

		<div id="secureContent" style="display: none;">
			<button id="languageToggle">FR</button>
			<form onsubmit="submitForm(); return false;">
				<input type="text" id="question" data-fr="Posez vos questions !" data-en="Ask your questions!"
					placeholder="Posez vos questions !" autocomplete="off" autofocus>
				<button type="submit" data-fr="Soumettre" data-en="Submit">Soumettre</button>
			</form>
			<p id="conferenceText"
				data-fr="Nous sommes ravis de vous inviter à notre prochaine conférence: <b>'Du savoir technique au professionnel: votre itinéraire vers le succès IT.'</b><br>
					En préparation d'une journée riche en opportunités de networking, nous aimerions récolter vos questions.<br>
					Elles seront posées aux intervenants (RH IT/recrutement technique) lors de l'évènement et donc doivent être <b>pertinentes</b> par rapport à celui-ci.<br>
					<b>Rejoignez-nous pour acquérir les connaissances nécessaires pour lancer votre parcours professionnel dans le secteur informatique.</b>"
				data-en="We are delighted to invite you to our upcoming conference: <b>'From Technical Knowledge to Professional: Your Journey to IT Success.'</b><br>
					In preparation for a day rich in networking opportunities, we would like to collect your questions.<br>
					They will be asked to the speakers (IT HR/technical recruitment) at the event and must therefore be <b>relevant</b> to it.<br>
					<b>Join us to gain the necessary knowledge to start your professional journey in the IT sector.</b>">
				Nous sommes ravis de vous inviter à notre prochaine conférence: <b>Du savoir technique au professionnel:
					votre itinéraire vers le succès IT</b><br>
				En préparation d'une journée riche en opportunités de networking, nous aimerions récolter vos
				questions.<br>
				Elles seront posées aux intervenants (RH IT/recrutement technique) lors de l'évènement et donc doivent
				être <b>pertinentes</b> par rapport à celui-ci.<br>
				<b>Rejoignez-nous pour acquérir les connaissances nécessaires pour lancer votre parcours professionel
					dans le secteur informatique.</b>
			</p>
		</div>
	</div>

	<script>
		document.getElementById('loginButton').addEventListener('click', function () {
			window.location.href = 'https://theomouty.fr/42explorer/?action=login';
		});

		function getAccessToken(code) {
			const apiUrl = 'https://theomouty.fr/42explorer/?code='.concat(code);
			fetch(apiUrl, {
				method: 'GET',
				headers: {
					'Content-Type': 'application/json',
				},
			})
				.then(response => response.json())
				.then(data => console.log(data))
				.catch((error) => {
					console.error('Error:', error);
				});
		}

		window.onload = function () {
			const urlParams = new URLSearchParams(window.location.search);
			const code = urlParams.get('code');
			const state = urlParams.get('state');

			if (code && state) {
				document.getElementById('loginButton').style.display = 'none';
				document.getElementById('secureContent').style.display = 'block';
				//getAccessToken(code);
			}
		};

		function submitForm() {
			var questionInput = document.getElementById('question');
			var question = questionInput.value.trim();
			var submitButton = document.querySelector('button[type="submit"]');

			if (question === "") {
				alert('Please enter a question.');
				questionInput.focus();
				return;
			}
			const apiUrl = 'https://theomouty.fr/42explorer/?message=' + question;
			fetch(apiUrl, {
				method: 'GET',
				headers: {
					'Content-Type': 'application/json',
				},
			})
				.then(response => response.json())
				.then(data => {
					console.log(data);
					if (data.code === '200') {
						alert('Question envoyée avec succès.');
					} else {
						alert('Erreur lors de l\'envoi de la question.');
					}
					questionInput.value = '';
				})
				.catch((error) => {
					console.error('Error:', error);
				});
			submitButton.disabled = true;
		}

		function toggleLanguage() {
			var currentLang = document.body.getAttribute('data-lang');
			var newLang = currentLang === 'en' ? 'fr' : 'en';

			document.body.setAttribute('data-lang', newLang);
			document.getElementById('languageToggle').textContent = newLang.toUpperCase();

			document.querySelectorAll('[data-fr]').forEach(function (el) {
				var newText = newLang === 'en' ? el.getAttribute('data-en') : el.getAttribute('data-fr');
				if (el.tagName.toLowerCase() === 'input') {
					el.placeholder = newText;
				} else if (el.tagName.toLowerCase() === 'button') {
					el.textContent = newText;
				} else {
					el.innerHTML = newText;
				}
			});
		}

		document.body.setAttribute('data-lang', 'fr');

		document.getElementById('languageToggle').addEventListener('click', function () {
			toggleLanguage();
			this.blur();
		});

	</script>
</body>

</html>
